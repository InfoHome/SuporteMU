DROP TABLE TAB_PARAMETROS_ORC
GO
CREATE TABLE tab_parametros_ORC (
   empresa     varchar(50),
   regiao     varchar(20),
   nivel1     varchar(20),
   nivel2     varchar(20),
   nivel3     varchar(20),
   nivel4     varchar(20),
   nivel5     varchar(20),
   nivel6     varchar(20),
   nivel7     varchar(20),
   nivel8     varchar(20),
   nivel9     varchar(20),
   nivel10     varchar(20),
   nivel11     varchar(20),
  nivel12     varchar(20),
  nivel13     varchar(20),
  nivel14     varchar(20),
  nivel15     varchar(20),
   atr1       varchar(20),
   atr2       varchar(20),
   atr3       varchar(20),
   atr4       varchar(20),
   atr5       varchar(20),
   atr6       varchar(20),
   atr7       varchar(20),
   atr8       varchar(20),
   atr9       varchar(20),
   atr10      varchar(20),
   atr11      varchar(20),
   atr12      varchar(20),
   atr13      varchar(20),
   atr14      varchar(20),
   atr15      varchar(20),
   atualizadoem datetime )
GO

insert into tab_parametros_ORC (empresa,nivel1,nivel2,nivel3,nivel4,nivel5,nivel6,NIVEL7,NIVEL8,NIVEL9,NIVEL10,NIVEL11,atr1,atr2,ATR3,ATR4)
 values ('DESEMPENHO DE VENDAS','TEMPO', 'FILIAL','VENDEDOR','CIDADE','CLIENTE','FORNECEDOR','CLASSE N1','CLASSE N2','CLASSE N3','PRODUTO','PEDIDO','VALOR_ORC','CUSTO_ORC','VALOR_VENDA','CUSTO_VENDA')
GO

IF NOT EXISTS (SELECT name FROM sysobjects WHERE name = 'TAB_INI' AND type = 'U')
CREATE TABLE TAB_INI(
           VISAO	nvarchar(50),
           CAMPO4	varchar(250),	
           CAMPO5	varchar(250),	
           CAMPO6	varchar(250),	
           CAMPO7	varchar(250),	
           CAMPO8	varchar(250), 
           CONSTRAINT PK_TAB_INI PRIMARY KEY NONCLUSTERED (VISAO) WITH FILLFACTOR=98)
GO

DELETE FROM TAB_INI WHERE VISAO = 'DESEMPENHO DE VENDAS'
GO

INSERT INTO TAB_INI  VALUES 
('DESEMPENHO DE VENDAS', 
 '*NIVEL1_ORC,NIVEL2_ORC,NIVEL3_ORC,NIVEL4_ORC,NIVEL5_ORC,NIVEL6_ORC,NIVEL7_ORC,NIVEL8_ORC,NIVEL9_ORC,NIVEL10_ORC,NIVEL11_ORC,NIVEL12_ORC',
 'TAB_NIVEL1_ORC,TAB_NIVEL2_ORC,TAB_NIVEL3_ORC,TAB_NIVEL4_ORC,TAB_NIVEL5_ORC,TAB_NIVEL6_ORC,TAB_NIVEL7_ORC,TAB_NIVEL8_ORC,TAB_NIVEL9_ORC,TAB_NIVEL10_ORC,TAB_NIVEL11_ORC' ,
 'TAB_PARAMETROS_ORC,TAB_SENHA_ORC,,ULTIMAS_ORC,,,CONSULTA_ORC,FORMULA_ORC',
 'NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,DATA,DESCRICAO,,,,,,,,,,ATR1,ATR2,ATR3,ATR4,ATR5,ATR6,ATR7,ATR8,ATR9,ATR10,' ,
 '08,02,05,10,25,51,10,02,04,06,05' )
GO

DROP TABLE TAB_NIVEL1_ORC                                --TEMPO
GO
CREATE TABLE TAB_NIVEL1_ORC (
	NIVEL1 char (10) NOT NULL ,
	DESCRICAO varchar (100) NULL ,
	MES VARchar (50) NULL ,
	BIMESTRE  VARchar (50) NULL ,
	TRIMESTRE VARchar (50) NULL ,
	QUADRIMESTRE VARchar (50) NULL ,
	SEMESTRE VARchar (50)  NULL ,
	ANO VARchar (50) NULL ,
	DIAUTIL VARCHAR(1) NULL,
        CONSTRAINT PK_TAB_NIVEL1_ORC PRIMARY KEY NONCLUSTERED (NIVEL1) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL1_ORC_1 ON TAB_NIVEL1_ORC (DESCRICAO)
CREATE INDEX FK_TAB_NIVEL1_ORC_2 ON TAB_NIVEL1_ORC (MES)
CREATE INDEX FK_TAB_NIVEL1_ORC_3 ON TAB_NIVEL1_ORC (BIMESTRE)
CREATE INDEX FK_TAB_NIVEL1_ORC_4 ON TAB_NIVEL1_ORC (TRIMESTRE)
CREATE INDEX FK_TAB_NIVEL1_ORC_5 ON TAB_NIVEL1_ORC (QUADRIMESTRE)
CREATE INDEX FK_TAB_NIVEL1_ORC_6 ON TAB_NIVEL1_ORC (SEMESTRE)
CREATE INDEX FK_TAB_NIVEL1_ORC_7 ON TAB_NIVEL1_ORC (ANO)
CREATE INDEX FK_TAB_NIVEL1_ORC_8 ON TAB_NIVEL1_ORC (DIAUTIL)
GO

DROP TABLE TAB_NIVEL2_ORC                             --FILIAL
GO
CREATE TABLE TAB_NIVEL2_ORC (
	NIVEL2 char (10) NOT NULL ,
	DESCRICAO varchar (50) NULL,
        CONSTRAINT PK_TAB_NIVEL2_ORC PRIMARY KEY NONCLUSTERED (NIVEL2) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL2_ORC_1 ON TAB_NIVEL2_ORC (DESCRICAO)
GO

DROP TABLE TAB_NIVEL3_ORC                             --VENDEDOR
GO
CREATE TABLE TAB_NIVEL3_ORC (
	NIVEL3 char (10) NOT NULL ,
	DESCRICAO varchar (50) NULL,
        GERENTE VARCHAR (50) NULL,
        CONSTRAINT PK_TAB_NIVEL3_ORC PRIMARY KEY NONCLUSTERED (NIVEL3) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL3_ORC_1 ON TAB_NIVEL3_ORC (DESCRICAO)
CREATE INDEX FK_TAB_NIVEL3_ORC_2 ON TAB_NIVEL3_ORC (GERENTE)
GO

DROP TABLE TAB_NIVEL4_ORC                             --CIDADE
GO
CREATE TABLE TAB_NIVEL4_ORC (
	NIVEL4 char(60) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL4_ORC PRIMARY KEY NONCLUSTERED (NIVEL4) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL4_ORC_2 ON TAB_NIVEL4_ORC (DESCRICAO)
GO

DROP TABLE TAB_NIVEL5_ORC                             --CLIENTE
GO
CREATE TABLE TAB_NIVEL5_ORC (
	NIVEL5 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL5_ORC PRIMARY KEY NONCLUSTERED (NIVEL5) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL5_ORC_2 ON TAB_NIVEL5_ORC (DESCRICAO)
GO


DROP TABLE TAB_NIVEL6_ORC                             --FORNECEDOR
GO
CREATE TABLE TAB_NIVEL6_ORC (
	NIVEL6 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL6_ORC PRIMARY KEY NONCLUSTERED (NIVEL6) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL6_ORC_2 ON TAB_NIVEL6_ORC (DESCRICAO)
GO
--===================================================================================================
DROP TABLE TAB_NIVEL7_ORC                             --CLASSE N1
GO
CREATE TABLE TAB_NIVEL7_ORC (
	NIVEL7 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL7_ORC PRIMARY KEY NONCLUSTERED (NIVEL7) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL7_ORC_2 ON TAB_NIVEL7_ORC (DESCRICAO)
GO

DROP TABLE TAB_NIVEL8_ORC                             --CLASSE N2
GO
CREATE TABLE TAB_NIVEL8_ORC (
	NIVEL8 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL8_ORC PRIMARY KEY NONCLUSTERED (NIVEL8) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL8_ORC_2 ON TAB_NIVEL8_ORC (DESCRICAO)
GO

DROP TABLE TAB_NIVEL9_ORC                             --CLASSE N3
GO
CREATE TABLE TAB_NIVEL9_ORC (
	NIVEL9 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL9_ORC PRIMARY KEY NONCLUSTERED (NIVEL9) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL9_ORC_2 ON TAB_NIVEL9_ORC (DESCRICAO)
GO
--===================================================================================================
DROP TABLE TAB_NIVEL10_ORC
GO																	-- PRODUTO
CREATE TABLE TAB_NIVEL10_ORC (
	NIVEL10 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        FORNECEDOR CHAR(50) NULL,
        COMPRADOR CHAR(50) NULL,
        CONSTRAINT PK_TAB_NIVEL10_ORC PRIMARY KEY NONCLUSTERED (NIVEL10) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL10_ORC_2 ON TAB_NIVEL10_ORC (DESCRICAO)
CREATE INDEX FK_TAB_NIVEL10_ORC_3 ON TAB_NIVEL10_ORC (FORNECEDOR)
CREATE INDEX FK_TAB_NIVEL10_ORC_4 ON TAB_NIVEL10_ORC (COMPRADOR)
GO

DROP TABLE TAB_NIVEL11_ORC                                         --PEDIDO
CREATE TABLE TAB_NIVEL11_ORC (
		NIVEL11 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL11_ORC PRIMARY KEY NONCLUSTERED (NIVEL11) WITH FILLFACTOR=98)

CREATE INDEX FK_TAB_NIVEL11_ORC_2 ON TAB_NIVEL11_ORC (DESCRICAO)

--=========================================================================
--=========================================================================
DROP TABLE NIVEL1_ORC
GO
CREATE TABLE NIVEL1_ORC (
	NIVEL1 char (10) NOT NULL ,
	DATA datetime NOT NULL ,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL1_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,DATA) WITH FILLFACTOR=98)
GO

DROP TABLE NIVEL2_ORC
GO
CREATE TABLE NIVEL2_ORC (
	NIVEL2 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	DATA datetime NOT NULL ,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL2_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL2_ORC_1 ON NIVEL2_ORC (NIVEL2,DATA)
GO

DROP TABLE NIVEL3_ORC
GO
CREATE TABLE NIVEL3_ORC (
	NIVEL3 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	DATA datetime NOT NULL ,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL3_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL3_ORC_1 ON NIVEL3_ORC (NIVEL3,DATA)
CREATE INDEX FK_NIVEL3_ORC_2 ON NIVEL3_ORC (NIVEL2,NIVEL3,DATA)
GO

DROP TABLE NIVEL4_ORC
GO
CREATE TABLE NIVEL4_ORC (
	NIVEL4 char (60) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	DATA datetime NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL4_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL4_ORC_1 ON NIVEL4_ORC (NIVEL4,DATA)
CREATE INDEX FK_NIVEL4_ORC_2 ON NIVEL4_ORC (NIVEL2,NIVEL3,NIVEL4,DATA)
GO

DROP TABLE NIVEL5_ORC
GO
CREATE TABLE NIVEL5_ORC (
	NIVEL5 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (60) NOT NULL ,
	DATA datetime NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL5_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL5_ORC_1 ON NIVEL5_ORC (NIVEL5,DATA)
CREATE INDEX FK_NIVEL5_ORC_2 ON NIVEL5_ORC (NIVEL2,NIVEL3,NIVEL4,NIVEL5,DATA)
GO


DROP TABLE NIVEL6_ORC
GO
CREATE TABLE NIVEL6_ORC (
	NIVEL6 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (60) NOT NULL ,
    NIVEL5 char (10) NOT NULL ,
	DATA datetime NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL6_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL6_ORC_1 ON NIVEL6_ORC (NIVEL6,DATA)
CREATE INDEX FK_NIVEL6_ORC_2 ON NIVEL6_ORC (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,DATA)
GO
--======================================================================================================

DROP TABLE NIVEL7_ORC
GO
CREATE TABLE NIVEL7_ORC (
	NIVEL7 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (60) NOT NULL ,
    NIVEL5 char (10) NOT NULL ,
    NIVEL6 CHAR (10) NOT NULL ,
	DATA datetime NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL7_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL7_ORC_1 ON NIVEL7_ORC (NIVEL7,DATA)
CREATE INDEX FK_NIVEL7_ORC_2 ON NIVEL7_ORC (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,DATA)
GO


DROP TABLE NIVEL8_ORC
GO
CREATE TABLE NIVEL8_ORC (
	NIVEL8 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (60) NOT NULL ,
    NIVEL5 char (10) NOT NULL ,
    NIVEL6 CHAR (10) NOT NULL ,
    NIVEL7 CHAR (10) NOT NULL ,
	DATA datetime NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
    CONSTRAINT PK_NIVEL8_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL8_ORC_1 ON NIVEL8_ORC (NIVEL8,DATA)
CREATE INDEX FK_NIVEL8_ORC_2 ON NIVEL8_ORC (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,DATA)
GO

--======================================================================================================
DROP TABLE NIVEL9_ORC
GO
CREATE TABLE NIVEL9_ORC (
	NIVEL9 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (60) NOT NULL ,
	NIVEL5 char (10) NOT NULL,
    NIVEL6 char (10) NOT NULL ,
    NIVEL7 char (10) NOT NULL,
    NIVEL8 char (10) NOT NULL ,
	DATA datetime NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL9_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,NIVEL9,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL9_ORC_1 ON NIVEL9_ORC (NIVEL9,DATA)
CREATE INDEX FK_NIVEL9_ORC_2 ON NIVEL9_ORC (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,NIVEL9,DATA)
GO
--================================================================

DROP TABLE NIVEL10_ORC
GO
CREATE TABLE NIVEL10_ORC (
	NIVEL10 char (10) NOT NULL ,
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (60) NOT NULL ,
	NIVEL5 char (10) NOT NULL,
    NIVEL6 char (10) NOT NULL ,
    NIVEL7 char (10) NOT NULL,
    NIVEL8 char (10) NOT NULL ,
    NIVEL9 char (10) NOT NULL ,
	DATA datetime NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
        CONSTRAINT PK_NIVEL10_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,NIVEL9,NIVEL10,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL10_ORC_1 ON NIVEL10_ORC (NIVEL10,DATA)
CREATE INDEX FK_NIVEL10_ORC_2 ON NIVEL10_ORC (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,NIVEL9,NIVEL10,DATA)
GO
--================================================================

DROP TABLE NIVEL11_ORC
GO
CREATE TABLE NIVEL11_ORC (
	NIVEL11 char (10) NOT NULL,	
	NIVEL1 char (10) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (60) NOT NULL ,
	NIVEL5 char (10) NOT NULL,
    NIVEL6 char (10) NOT NULL ,
    NIVEL7 char (10) NOT NULL  ,
    NIVEL8 char (10) NOT NULL,
    NIVEL9 char (10) NOT NULL ,
    NIVEL10 char (10) NOT NULL ,
	DATA datetime NOT NULL,
	TIPO CHAR(1),
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
    CONSTRAINT PK_NIVEL11_ORC PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,NIVEL9,NIVEL10,NIVEL11,DATA, TIPO) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL11_ORC_1 ON NIVEL11_ORC (NIVEL11,DATA)
CREATE INDEX FK_NIVEL11_ORC_2 ON NIVEL11_ORC (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,NIVEL8,NIVEL9,NIVEL10,NIVEL11,DATA)
GO


