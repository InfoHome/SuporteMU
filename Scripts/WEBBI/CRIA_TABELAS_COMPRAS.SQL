DROP TABLE TAB_PARAMETROS_COMPRAS
GO
CREATE TABLE tab_parametros_COMPRAS (
   empresa    varchar(50),
   nivel1     varchar(20),
   nivel2     varchar(20),
   nivel3     varchar(20),
   nivel4     varchar(20),
   nivel5     varchar(20),
   nivel6     varchar(20),
   nivel7     varchar(20),
   nivel8     varchar(20),
   nivel9     varchar(20),
   nivel10    varchar(20),
   nivel11    varchar(20),
   nivel12    varchar(20),
   nivel13    varchar(20),
   nivel14    varchar(20),
   nivel15    varchar(20),
   atr1       varchar(20),
   atr2       varchar(20),
   atr3       varchar(20),
   atr4       varchar(20),
   atr5       varchar(20),
   atr6       varchar(20),
   atr7       varchar(20),
   atr8       varchar(20),
   atr9       varchar(20),
   atr10      varchar(20),
   atr11      varchar(20),
   atr12      varchar(20),
   atr13      varchar(20),
   atr14      varchar(20),
   atr15      varchar(20),
   atualizadoem datetime)
GO

insert into tab_parametros_COMPRAS (empresa,nivel1,nivel2,nivel3,nivel4,nivel5,NIVEL6,NIVEL7,atr1,atr2,ATR3,ATR4,ATR5)
 values ('GERENCIAL DE COMPRAS','TEMPO', 'FILIAL','FORNECEDOR','CLASSE N1','CLASSE N2','CLASSE N3','PRODUTO','QT_COMP','VALOR_COMP','CUSTO_FINAL','PRAZO','NUM_COMP')
go

IF NOT EXISTS (SELECT name FROM sysobjects WHERE name = 'TAB_INI' AND type = 'U')
   CREATE TABLE TAB_INI(
           VISAO	nvarchar(50),
           CAMPO4	varchar(250),	
           CAMPO5	varchar(250),	
           CAMPO6	varchar(250),	
           CAMPO7	varchar(250),	
           CAMPO8	varchar(250), 
           CONSTRAINT PK_TAB_INI PRIMARY KEY NONCLUSTERED (VISAO) WITH FILLFACTOR=98)
GO

delete from tab_ini where visao = 'GERENCIAL DE COMPRAS'
GO

INSERT INTO TAB_INI  VALUES 
('GERENCIAL DE COMPRAS', 
 '*NIVEL1_COMPRAS,NIVEL2_COMPRAS,NIVEL3_COMPRAS,NIVEL4_COMPRAS,NIVEL5_COMPRAS,NIVEL6_COMPRAS,NIVEL7_COMPRAS',
 'TAB_NIVEL1_COMPRAS,TAB_NIVEL2_COMPRAS,TAB_NIVEL3_COMPRAS,TAB_NIVEL4_COMPRAS,TAB_NIVEL5_COMPRAS,TAB_NIVEL6_COMPRAS,TAB_NIVEL7_COMPRAS' ,
 'TAB_PARAMETROS_COMPRAS,TAB_SENHA_COMPRAS,,ULTIMAS_COMPRAS,,,CONSULTA_COMPRAS,FORMULA_COMPRAS',
 'NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,DATA,DESCRICAO,,,,,,,,,,ATR1,ATR2,ATR3,ATR4,ATR5,ATR6,ATR7,ATR8,ATR9,ATR10,' ,
 '08,02,05,02,05,09,05' )
GO

DROP TABLE TAB_NIVEL1_COMPRAS                                                   --TEMPO
GO
CREATE TABLE TAB_NIVEL1_COMPRAS (
	NIVEL1 char (8) NOT NULL ,
	DESCRICAO varchar (100) NULL ,
	MES VARchar (50) NULL ,
	BIMESTRE  VARchar (50) NULL ,
	TRIMESTRE VARchar (50) NULL ,
	QUADRIMESTRE VARchar (50) NULL ,
	SEMESTRE VARchar (50)  NULL ,
	ANO VARchar (50) NULL ,
	DIAUTIL VARCHAR(1) NULL,
        CONSTRAINT PK_TAB_NIVEL1_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1) WITH FILLFACTOR=98)
GO

CREATE INDEX FK_TAB_NIVEL1_COMPRAS_1 ON TAB_NIVEL1_COMPRAS (DESCRICAO)
CREATE INDEX FK_TAB_NIVEL1_COMPRAS_2 ON TAB_NIVEL1_COMPRAS (MES)
CREATE INDEX FK_TAB_NIVEL1_COMPRAS_3 ON TAB_NIVEL1_COMPRAS (BIMESTRE)
CREATE INDEX FK_TAB_NIVEL1_COMPRAS_4 ON TAB_NIVEL1_COMPRAS (TRIMESTRE)
CREATE INDEX FK_TAB_NIVEL1_COMPRAS_5 ON TAB_NIVEL1_COMPRAS (QUADRIMESTRE)
CREATE INDEX FK_TAB_NIVEL1_COMPRAS_6 ON TAB_NIVEL1_COMPRAS (SEMESTRE)
CREATE INDEX FK_TAB_NIVEL1_COMPRAS_7 ON TAB_NIVEL1_COMPRAS (ANO)
CREATE INDEX FK_TAB_NIVEL1_COMPRAS_8 ON TAB_NIVEL1_COMPRAS (DIAUTIL)
GO

DROP TABLE TAB_NIVEL2_COMPRAS                                                --FILIAL
GO
CREATE TABLE TAB_NIVEL2_COMPRAS (
	NIVEL2 char (10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL2_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL2) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL2_COMPRAS_1 ON TAB_NIVEL2_COMPRAS (DESCRICAO)
GO

DROP TABLE TAB_NIVEL3_COMPRAS                                               --FORNECEDOR
GO
CREATE TABLE TAB_NIVEL3_COMPRAS (
	NIVEL3 char (10) NOT NULL ,
	DESCRICAO varchar (50) NULL,
        CONSTRAINT PK_TAB_NIVEL3_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL3) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL3_COMPRAS_1 ON TAB_NIVEL3_COMPRAS (DESCRICAO)
GO



DROP TABLE TAB_NIVEL4_COMPRAS                                             --classe n1
GO
CREATE TABLE TAB_NIVEL4_COMPRAS (
	    NIVEL4 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL4_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL4) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL4_COMPRAS_2 ON TAB_NIVEL4_COMPRAS (DESCRICAO)
GO

--=================
DROP TABLE TAB_NIVEL5_COMPRAS                                             --classe n2
GO
CREATE TABLE TAB_NIVEL5_COMPRAS (
	    NIVEL5 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL5_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL5) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL5_COMPRAS_2 ON TAB_NIVEL5_COMPRAS (DESCRICAO)
GO

--=================
DROP TABLE TAB_NIVEL6_COMPRAS                                             --classe n3
GO
CREATE TABLE TAB_NIVEL6_COMPRAS (
	    NIVEL6 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        CONSTRAINT PK_TAB_NIVEL6_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL6) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL6_COMPRAS_2 ON TAB_NIVEL6_COMPRAS (DESCRICAO)
GO

--=================
DROP TABLE TAB_NIVEL7_COMPRAS                                             --PRODUTO
GO
CREATE TABLE TAB_NIVEL7_COMPRAS (
		NIVEL7 char(10) NOT NULL ,
        DESCRICAO varchar (100) NULL,
        FORN_PROD CHAR(50) NULL,
        COMPRADOR CHAR(50) NULL,
        MODELO CHAR(50) NULL,
        CONSTRAINT PK_TAB_NIVEL7_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL7) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_TAB_NIVEL7_COMPRAS_2 ON TAB_NIVEL7_COMPRAS (DESCRICAO)
CREATE INDEX FK_TAB_NIVEL7_COMPRAS_3 ON TAB_NIVEL7_COMPRAS (FORN_PROD)
CREATE INDEX FK_TAB_NIVEL7_COMPRAS_4 ON TAB_NIVEL7_COMPRAS (COMPRADOR)
CREATE INDEX FK_TAB_NIVEL7_COMPRAS_5 ON TAB_NIVEL7_COMPRAS (MODELO)
GO

--=================================================================================================

DROP TABLE NIVEL1_COMPRAS
GO
CREATE TABLE NIVEL1_COMPRAS (
	NIVEL1 char (8) NOT NULL ,
	DATA datetime NOT NULL ,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
	ATR5 float NULL ,
	ATR6 float NULL ,
        CONSTRAINT PK_NIVEL1_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1,DATA) WITH FILLFACTOR=98)
GO

DROP TABLE NIVEL2_COMPRAS
GO
CREATE TABLE NIVEL2_COMPRAS (
	NIVEL2 char (10) NOT NULL ,
	NIVEL1 char (8) NOT NULL ,
	DATA datetime NOT NULL ,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
	ATR5 float NULL ,
	ATR6 float NULL ,
        CONSTRAINT PK_NIVEL2_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,DATA) WITH FILLFACTOR=98)
GO 
CREATE INDEX FK_NIVEL2_COMPRAS_1 ON NIVEL2_COMPRAS (NIVEL2,DATA)
GO

DROP TABLE NIVEL3_COMPRAS
GO
CREATE TABLE NIVEL3_COMPRAS (
	NIVEL3 char (10) NOT NULL ,
	NIVEL1 char (8) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	DATA datetime NOT NULL ,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
	ATR5 float NULL ,
	ATR6 float NULL ,
        CONSTRAINT PK_NIVEL3_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL3_COMPRAS_1 ON NIVEL3_COMPRAS (NIVEL3,DATA)
CREATE INDEX FK_NIVEL3_COMPRAS_2 ON NIVEL3_COMPRAS (NIVEL2,NIVEL3,DATA)
GO


DROP TABLE NIVEL4_COMPRAS
GO
CREATE TABLE NIVEL4_COMPRAS (
	NIVEL4 char (10) NOT NULL ,
	NIVEL1 char (8) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	DATA datetime NOT NULL ,
     	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
	ATR5 float NULL ,
	ATR6 float NULL,
        CONSTRAINT PK_NIVEL4_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL4_COMPRAS_1 ON NIVEL4_COMPRAS (NIVEL4,DATA)
CREATE INDEX FK_NIVEL4_COMPRAS_2 ON NIVEL4_COMPRAS (NIVEL2,NIVEL3,NIVEL4,DATA)
GO

--===========================

DROP TABLE NIVEL5_COMPRAS
GO
CREATE TABLE NIVEL5_COMPRAS (
	NIVEL5 char (10) NOT NULL ,
	NIVEL1 char (8) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 CHAR (10) NOT NULL ,
	DATA datetime NOT NULL ,
    ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
	ATR5 float NULL ,
	ATR6 float NULL,
    CONSTRAINT PK_NIVEL5_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL5_COMPRAS_1 ON NIVEL5_COMPRAS (NIVEL5,DATA)
CREATE INDEX FK_NIVEL5_COMPRAS_2 ON NIVEL5_COMPRAS (NIVEL2,NIVEL3,NIVEL4,NIVEL5,DATA)
GO

--===========================

DROP TABLE NIVEL6_COMPRAS
GO
CREATE TABLE NIVEL6_COMPRAS (
	NIVEL6 char (10) NOT NULL ,
	NIVEL1 char (8) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 CHAR (10) NOT NULL ,
	NIVEL5 CHAR (10) NOT NULL ,
	DATA datetime NOT NULL ,
    ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
	ATR5 float NULL ,
	ATR6 float NULL,
    CONSTRAINT PK_NIVEL6_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,DATA) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL6_COMPRAS_1 ON NIVEL6_COMPRAS (NIVEL6,DATA)
CREATE INDEX FK_NIVEL6_COMPRAS_2 ON NIVEL6_COMPRAS (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,DATA)
GO

--===========================
DROP TABLE NIVEL7_COMPRAS
GO
CREATE TABLE NIVEL7_COMPRAS (
	NIVEL7 char (10) NOT NULL ,
	NIVEL1 char (8) NOT NULL ,
	NIVEL2 char (10) NOT NULL ,
	NIVEL3 char (10) NOT NULL ,
	NIVEL4 char (10) NOT NULL ,
	NIVEL5 CHAR (10) NOT NULL ,
	NIVEL6 CHAR (10) NOT NULL ,
	DATA datetime NOT NULL ,
    TIPO CHAR(1) NOT NULL,
	ATR1 float NULL ,
	ATR2 float NULL ,
	ATR3 float NULL ,
	ATR4 float NULL ,
	ATR5 float NULL ,
	ATR6 float NULL,
        CONSTRAINT PK_NIVEL7_COMPRAS PRIMARY KEY NONCLUSTERED (NIVEL1,NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,DATA,TIPO) WITH FILLFACTOR=98)
GO
CREATE INDEX FK_NIVEL7_COMPRAS_1 ON NIVEL7_COMPRAS (NIVEL7,DATA)
CREATE INDEX FK_NIVEL7_COMPRAS_2 ON NIVEL7_COMPRAS (NIVEL2,NIVEL3,NIVEL4,NIVEL5,NIVEL6,NIVEL7,DATA)
GO