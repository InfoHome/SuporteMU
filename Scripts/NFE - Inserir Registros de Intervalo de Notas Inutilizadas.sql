

Begin transaction
go
Declare @NNumord int, @NumordFinal int, @NNFInicial char(6) , @NNFFinal char(6), @Count int  
declare @sqlnCFOSaidCad varchar(5000), @sqlnNFSaida varchar(5000),  @sqlDadosNotaNFE varchar(5000), @sqlComplementoNFSaida varchar(5000)

set @NNumord = 772590			--Informa o numord inicial a ser utilizado
set @NumordFinal = 772591		--Informa o numord final a ser utilizado
set @Count = '000003'		--Informa a nota inicial a ser utilizada
set @NNFFinal = '000004'	--Informa a nota final a ser utilizada

WHILE @Count <= @NNFFinal
BEGIN
  
   --PRINT 'NNF ' + RIGHT('000000' + LTRIM(RTRIM(@Count)),6) +' '+ convert(varchar, @NNumord);  
	select @sqlnNFSaida = 'INSERT INTO nfsaidacad(NUMNOTA,SERIE,CODCLIE,DTEMIS,ESPDOC,FILIAL,ESTADO,CFO,TPO,VALCONTAB,BASEICM,BASEICM2,BASEICM3,ALQICM,ALQICM2,ALQICM3,VALICM,VALICM2,VALICM3,BASEIPI,VALIPI,VALSEMICM,VALSEMIPI,BASESTRIB,VALSUBSTRI,VALTRIBDIF,DESTAQIPI,VALSERVICO,VALISS,VALFRETE,VALSEGURO,FRETEINC,OUTRICM,OUTRIPI,CCUSTO,OBS,CODVEND,NUMPED,VALENTRAD,CODMETRA,CODTRAN,DESCONTO,COMISSAO,NUMORD,FATURADO,ATUALIZ,FLAGEMIT,FLAGREGFIS,FLAGATUA,ICMSIPI,VALEMBA,CODROTE,CODNATOP,FILTRANSF,TIPONF,FLAGINTER,FLAGCONTAB,CODSITEST,CODSITFED,PERCSUBST,LUCRO,REC,CXA,FLU,CTB,ATF,CUS,INTEGRADO,DTCANCEL,BASEISS,MODELONF,CONDPAG,EST,LIF,FAT,EXPORTADO,CODMES,PERIPI,LOCALPORTA,CONTA,CODTRAN2,CUPOMINI,CUPOMFIM,GVE,BASEICM4,ALQICM4,VALICM4,CLASVEND,FLAGCONS,CLIFIM,EXPORTA,PEDIMPO,TIPONOTA,NUMECF,NUMCUPON,VALNFCHE,CLIENTEA,NORDVEN,NUMNFECF,BASEICM5,ALQICM5,VALICM5,NUMORDFIS,IMPOGER,ICMSFONTE,TOTMERC,TOTPESO,TXFINAN,EXCED,CODLIS,OIDDOCDEORIGEM,ATUACUM,JACOMIS,CONTABILIZADO,CODFOROUT,DEPORIGEM,TPOOUTRAENT,CONTREDZ,GT,BASEIR,ALIQIR,CODGER,OIDREVENDA,HISTORICO,BASEINSS,ALIQINSS,VALINSS,ALIQISSRET,BASEISSRET,VALISSRET,VALIRRF,NFFUTURA,NORDEXPEDIC,VALIDADE,SITPRODUTO,DESPNAOINCLUSAS,ICMSDESPNAOINCLUSAS,FRETESUBSTRIBUTARIA,SERIEECF,GTFIM,VALCANECF,VALDESCECF,CONTREIOPE,OUTRASDESPESASINCLUSAS,TIPOENTR,NUMORDECF,TOTALPRECOCOMICMS,TOTALVALORICMS,DESPESASIMPORTACAO,OIDSERIALECF) VALUES(' + RIGHT('000000' + LTRIM(RTRIM(@Count)),6)+ ',''0'',7,''20161020'',''NF'',''01'',''ES'',''5102'',''20113'',0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,'''',0.0000,0.0000,0.0000,0.0000,'''',0.0000,0.0000,'''','''','''',7,0.0000,'''','''',0.0000,0.0000,'+ convert(varchar, @NNumord) +',0.0000,0.0000,0.0000,0.0000,0.0000,'''',0.0000,'''',0,'''',''24'',0.0000,0.0000,'''','''',0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,'''',0.0000,Null,0.0000,''55'',7,'''',1.0000,0.0000,0.0000,'''',0.0000,7,7,'''','''','''',0.0000,0.0000,0.0000,0.0000,'''',0.0000,0,0.0000,'''','''','''','''',0.0000,0,0,'''',0.0000,0.0000,0.0000,0,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,'''',Null,0.0000,0.0000,0.0000,7,'''',7,'''',0.0000,0.0000,0.0000,'''',Null,'''',0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,Null,0.0000,0.0000,0.0000,0.0000,0.0000,'''',Null,Null,Null,'''',0.0000,'''',Null,0.0000,0.0000,0.0000,12)'
	select @sqlnCFOSaidCad = 'INSERT INTO cfosaidcad(NUMNOTA,SERIE,CODCLIE,NUMORD,CFO,CODNATOP,BASEICM,BASEICM2,BASEICM3,BASEICM4,BASEICM5,ALQICM,ALQICM2,ALQICM3,ALQICM4,ALQICM5,VALICM,VALICM2,VALICM3,VALICM4,VALICM5,OUTRICM,VALSEMICM,BASEIPI,ALIQIPI,VALIPI,OUTRIPI,VALSEMIPI,VALSUBSTRI,VALTRIBDIF,PERCSUBST,BASESTRIB,OBSVALORIPI,OBSBASESUBSTRI,OBSVALSUBSTRI)	VALUES('+RIGHT('000000' + LTRIM(RTRIM(@Count)),6)+',''0'',7,'+ convert(varchar, @NNumord) +',''5102'',0,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,Null,Null,Null)'
	select @sqlDadosNotaNFE = 'INSERT INTO dadosnotanfe(CEP,CEPD,CMUN,CMUND,CMUNFG,CNAE,CNF,CNPJ,CNPJD,CPAIS,CPAISD,CUF,DEMI,DSAIENT,FEMAIL,FINNFE,FONE,FONED,IE,IED,IEST,IM,INDPAG,INFCANHOTO,INFCPL,ISUF,JUSTIFICATIVAINUTILIZACAO,MOD,NATOP,NNF,NNFFINAL,NRO,NROD,NUMORD,PCOFINS,PPIS,SERIE,TPEMIS,TPNF,UF,UFD,UFEMBARQ,VBC,VBCISS,VBCOFINS,VBCPIS,VBCST,VCOFINS,VDESC,VERPROC,VFRETE,VICMS,VII,VIPI,VISS,VNF,VOUTRO,VPIS,VPROD,VRETCSLL,VSEG,VST,XBAIRRO,XBAIRROD,XCPL,XCPLD,XFAN,XLGR,XLGRD,XLOCEMBARQ,XMUN,XMUND,XNOME,XNOMED,XPAIS,XPAISD,CRT,HSAIENT,EMAIL,XJUST,DHCONT,IDDEST,INDFINAL,INDPRES,IDESTRANGEIRO,INDIEDEST,VICMSDESON,INFADFISCO,VFCPUFDEST,VICMSUFDEST,VICMSUFREMET) VALUES('''','''',0.0000,0.0000,0.0000,0.0000,0.0000,''30784664000150'','''',0.0000,0.0000,0.0000,''20161020'',Null,0,Null,0.0000,0.0000,'''','''','''','''',0.0000,Null,Null,'''','''',''55'','''','+RIGHT('000000' + LTRIM(RTRIM(@Count)),6)+',10000.0000,'''','''','+convert(varchar,@NNumord)+',0.0000,0.0000,0.0000,Null,0.0000,'''','''','''',0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,Null,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,'''','''','''','''','''','''','''','''','''','''','''','''','''','''','''',Null,'''','''',Null,1,0,1,'''',Null,Null,Null,Null,Null,Null)'
	select @sqlComplementoNFSaida = 'INSERT INTO complementonfsaida(BASEICMDESTACADO,CODIGOREGIAO,CONSULTASUFRAMA,COTACAOMOEDA,EXPEDIDOR,FRETEPAGAR,GERARNFSERVICO,KMATUAL,KMMES,MOEDA,MOTORISTA,NUMORD,NUMORDNFVENDA,NUMORDPRODPROPRIO,NUMPEDREGIONAL,OIDCONTRATANTE,PERCENTUALCOFINS,PERCENTUALPIS,PERCICMDESTACADO,PLACA,PREVISAOENTREGA,RESPONSAVELCONSULTA,SITUACAOCADASTROSUFRAMA,STATUSCONSIGNACAO,TIPOFRETE,VALORFRETEDESTACADO,VALORICMFRETE,CODVENDEXT,ITINERARIO,MARKUPREALTOTAL,NUMEROEMPENHO,NUMPEDPRODREL,ORDEM,UNIDADEEXECUTORA,VALORICMSDISPENSADO,MANUAL,OBSERVACAO,CLASSE,VALCUSTOFRETE,AIDF,DTEMIS,CODIGONFE,RECIBONFE,CHAVEDEACESSONFE,SITUACAONFE,ADE_ATODECLARATORIO,ADE_DATADOCUMENTO,ADE_MODELODOCUMENTO,ADE_NUMERODOCUMENTO,ADE_PARTICIPANTE,ADE_SERIEDOCUMENTO,CODPROCONJ,DESCONTODEVOLUCAO,DESCONTOSUFRAMA,ETIQUETAEMITIDA,FILIALNFE,FINNFE,FLAGEMITCONTINGENCIA,FLAGPESOALTERADO,ISSCIDADE,JUSTIFICATIVA,LOTENFE,NFEIMPORTADA,NUMEROPROTOCOLO,NUMEROPROTOCOLOCANCELAMENTO,NUMEROPROTOCOLOINUTILIZACAO,NUMORDCONTINGENCIA,NUMPEDAUTOMATICO,OIDDOCDEORIGEMCOMISSAO,OIDDOCDEORIGEMFRETE,PERCENTUALCOMISSAO,QUANTCONJ,RATENDIMENTO,RECIBODPEC,VALORACRESCIMO,VALORICMFRETEO,DHPROTOCOLO,DHRECIBODPEC,DHCANCELAMENTO,DHINUTILIZAÇÃO,FLAGPISCOFINS,REDZMANUAL,VALORDESCONTOPISCOFINS,RECEBIMENTOTEF,USULIBCANCELAMENTONF,TOTALTRIBUTO,DHEMISSAO,COD_INF_COMPL,DES_INF_COMPL,CHAVECANCELAMENTOCFE)	VALUES(Null,Null,Null,0.0000,Null,Null,Null,Null,Null,Null,Null,'+convert(varchar, @NNumord)+',Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,Null,'''',0,0.0000,Null,Null,Null,Null,Null,Null,''INUTILIZACAONFEAVULSA'','''',Null,'''',''20161020'',0.0000,0.0000,Null,''T'','''',Null,'''','''','''','''',Null,Null,0.0000,0.0000,''01'',Null,Null,Null,0.0000,''Utilização incorreta da série ocorrida a quebra de sequência'',Null,'''',0.0000,0.0000,332160037374914,Null,0,Null,Null,0.0000,Null,Null,Null,Null,Null,Null,Null,Null,''20161020'',0.0000,0.0000,0.0000,0.0000,Null,0.0000,Null,'''','''',Null)'

   set @Count = RIGHT('000000' + LTRIM(RTRIM(@Count)),6) + 1
   set @NNumord = @NNumord + 1
   PRINT @sqlnNFSaida;
   PRINT @sqlnCFOSaidCad;
   PRINT @sqlDadosNotaNFE;
   PRINT @sqlComplementoNFSaida;
   --execute @sqlnNFSaida;
   --execute @sqlnCFOSaidCad;
   --execute @sqlDadosNotaNFE;
   --execute @sqlComplementoNFSaida;

   IF (@Count > @NNFFinal and @NNumord > @NumordFinal)
      BREAK  
   ELSE  
      CONTINUE  
END  

--PRINT 'Termino do prcessamento';  

--rollback
--commit



